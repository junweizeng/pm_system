(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-757161b0"],{"7c3b":function(e,t,r){},ca94:function(e,t,r){"use strict";r.d(t,"i",(function(){return o})),r.d(t,"d",(function(){return i})),r.d(t,"k",(function(){return n})),r.d(t,"c",(function(){return a})),r.d(t,"b",(function(){return c})),r.d(t,"h",(function(){return l})),r.d(t,"j",(function(){return d})),r.d(t,"e",(function(){return u})),r.d(t,"g",(function(){return f})),r.d(t,"f",(function(){return m})),r.d(t,"l",(function(){return p})),r.d(t,"a",(function(){return h}));var s=r("b775");function o(e){return Object(s["a"])({url:"/workflow/process/list",method:"get",params:e})}function i(e){return Object(s["a"])({url:"/workflow/process/getProcessForm",method:"get",params:e})}function n(e,t){return Object(s["a"])({url:"/workflow/process/start/"+e,method:"post",data:t})}function a(e){return Object(s["a"])({url:"/workflow/process/bpmnXml/"+e,method:"get"})}function c(e){return Object(s["a"])({url:"/workflow/process/detail",method:"get",params:e})}function l(e){return Object(s["a"])({url:"/workflow/process/ownList",method:"get",params:e})}function d(e){return Object(s["a"])({url:"/workflow/process/todoList",method:"get",params:e})}function u(e){return Object(s["a"])({url:"/workflow/process/claimList",method:"get",params:e})}function f(e){return Object(s["a"])({url:"/workflow/process/finishedList",method:"get",params:e})}function m(e){return Object(s["a"])({url:"/workflow/process/copyList",method:"get",params:e})}function p(e){return Object(s["a"])({url:"/workflow/task/stopProcess",method:"post",data:e})}function h(e){return Object(s["a"])({url:"/workflow/instance/delete/?instanceId="+e,method:"delete"})}},ff87:function(e,t,r){"use strict";var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"process-viewer"},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isLoading,expression:"!isLoading"}],ref:"processCanvas",staticClass:"process-canvas",staticStyle:{height:"100%"}}),t("defs",{ref:"customSuccessDefs"},[t("marker",{attrs:{id:"sequenceflow-end-white-success",viewBox:"0 0 20 20",refX:"11",refY:"10",markerWidth:"10",markerHeight:"10",orient:"auto"}},[t("path",{staticClass:"success-arrow",staticStyle:{"stroke-width":"1px","stroke-linecap":"round","stroke-dasharray":"10000, 1"},attrs:{d:"M 1 5 L 11 10 L 1 15 Z"}})]),t("marker",{attrs:{id:"conditional-flow-marker-white-success",viewBox:"0 0 20 20",refX:"-1",refY:"10",markerWidth:"10",markerHeight:"10",orient:"auto"}},[t("path",{staticClass:"success-conditional",staticStyle:{"stroke-width":"1px","stroke-linecap":"round","stroke-dasharray":"10000, 1"},attrs:{d:"M 0 10 L 8 6 L 16 10 L 8 14 Z"}})])]),t("defs",{ref:"customFailDefs"},[t("marker",{attrs:{id:"sequenceflow-end-white-fail",viewBox:"0 0 20 20",refX:"11",refY:"10",markerWidth:"10",markerHeight:"10",orient:"auto"}},[t("path",{staticClass:"fail-arrow",staticStyle:{"stroke-width":"1px","stroke-linecap":"round","stroke-dasharray":"10000, 1"},attrs:{d:"M 1 5 L 11 10 L 1 15 Z"}})]),t("marker",{attrs:{id:"conditional-flow-marker-white-fail",viewBox:"0 0 20 20",refX:"-1",refY:"10",markerWidth:"10",markerHeight:"10",orient:"auto"}},[t("path",{staticClass:"fail-conditional",staticStyle:{"stroke-width":"1px","stroke-linecap":"round","stroke-dasharray":"10000, 1"},attrs:{d:"M 0 10 L 8 6 L 16 10 L 8 14 Z"}})])]),t("el-dialog",{staticClass:"comment-dialog",attrs:{title:e.dlgTitle||"审批记录",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-row",[t("el-table",{attrs:{data:e.taskCommentList,size:"mini",border:"","header-cell-class-name":"table-header-gray"}},[t("el-table-column",{attrs:{label:"序号","header-align":"center",align:"center",type:"index",width:"55px"}}),t("el-table-column",{attrs:{label:"候选办理",prop:"candidate",width:"150px",align:"center"}}),t("el-table-column",{attrs:{label:"实际办理",prop:"assigneeName",width:"100px",align:"center"}}),t("el-table-column",{attrs:{label:"处理时间",prop:"createTime",width:"140px",align:"center"}}),t("el-table-column",{attrs:{label:"办结时间",prop:"finishTime",width:"140px",align:"center"}}),t("el-table-column",{attrs:{label:"耗时",prop:"duration",width:"100px",align:"center"}}),t("el-table-column",{attrs:{label:"审批意见",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.commentList&&t.row.commentList[0]?t.row.commentList[0].fullMessage:"")+" ")]}}])})],1)],1)],1),t("div",{staticStyle:{position:"absolute",top:"0px",left:"0px",width:"100%"}},[t("el-row",{attrs:{type:"flex",justify:"end"}},[t("el-button-group",{key:"scale-control",attrs:{size:"medium"}},[t("el-button",{attrs:{size:"medium",type:"default",plain:!0,disabled:e.defaultZoom<=.3,icon:"el-icon-zoom-out"},on:{click:function(t){return e.processZoomOut()}}}),t("el-button",{staticStyle:{width:"90px"},attrs:{size:"medium",type:"default"}},[e._v(e._s(Math.floor(10*this.defaultZoom*10)+"%"))]),t("el-button",{attrs:{size:"medium",type:"default",plain:!0,disabled:e.defaultZoom>=3.9,icon:"el-icon-zoom-in"},on:{click:function(t){return e.processZoomIn()}}}),t("el-button",{attrs:{size:"medium",type:"default",icon:"el-icon-c-scale-to-original"},on:{click:function(t){return e.processReZoom()}}}),e._t("default")],2)],1)],1)],1)},o=[],i=r("c7eb"),n=r("1da1"),a=(r("d9e2"),r("b0c0"),r("4de4"),r("d3b7"),r("159b"),r("caad"),r("2532"),r("7c3b"),r("88eb")),c=r("041f"),l={props:{xml:{type:String},finishedInfo:{type:Object},allCommentList:{type:Array}},data:function(){return{dialogVisible:!1,dlgTitle:void 0,defaultZoom:1,isLoading:!1,bpmnViewer:void 0,processNodeInfo:void 0,selectTaskId:void 0,taskCommentList:[],hoverTimer:null}},watch:{xml:{handler:function(e){this.importXML(e)},immediate:!0},finishedInfo:{handler:function(e){this.setProcessStatus(e)},immediate:!0}},created:function(){},methods:{processReZoom:function(){this.defaultZoom=1,this.bpmnViewer.get("canvas").zoom("fit-viewport","auto")},processZoomIn:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,t=Math.floor(100*this.defaultZoom+100*e)/100;if(t>4)throw new Error("[Process Designer Warn ]: The zoom ratio cannot be greater than 4");this.defaultZoom=t,this.bpmnViewer.get("canvas").zoom(this.defaultZoom)},processZoomOut:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,t=Math.floor(100*this.defaultZoom-100*e)/100;if(t<.2)throw new Error("[Process Designer Warn ]: The zoom ratio cannot be less than 0.2");this.defaultZoom=t,this.bpmnViewer.get("canvas").zoom(this.defaultZoom)},getOperationTagType:function(e){return"success"},clearViewer:function(){this.$refs.processCanvas&&(this.$refs.processCanvas.innerHTML=""),this.bpmnViewer&&this.bpmnViewer.destroy(),this.bpmnViewer=null},addCustomDefs:function(){var e=this.bpmnViewer.get("canvas"),t=e._svg,r=this.$refs.customSuccessDefs,s=this.$refs.customFailDefs;t.appendChild(r),t.appendChild(s)},onSelectElement:function(e){var t=this;this.selectTaskId=void 0,this.dlgTitle=void 0,null!=this.processNodeInfo&&null!=this.processNodeInfo.finishedTaskSet&&null!=e&&-1!==this.processNodeInfo.finishedTaskSet.indexOf(e.id)&&(this.selectTaskId=e.id,this.dlgTitle=e.businessObject?e.businessObject.name:void 0,this.taskCommentList=(this.allCommentList||[]).filter((function(e){return e.activityId===t.selectTaskId})),this.dialogVisible=!0)},importXML:function(e){var t=this;return Object(n["a"])(Object(i["a"])().mark((function r(){return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.clearViewer(),null==e||""===e){r.next=19;break}return r.prev=2,t.bpmnViewer=new a["a"]({additionalModules:[c["a"]],container:t.$refs.processCanvas}),t.bpmnViewer.on("element.click",(function(e){var r=e.element;t.onSelectElement(r)})),t.isLoading=!0,r.next=8,t.bpmnViewer.importXML(e);case 8:t.addCustomDefs(),r.next=14;break;case 11:r.prev=11,r.t0=r["catch"](2),t.clearViewer();case 14:return r.prev=14,t.isLoading=!1,t.setProcessStatus(t.processNodeInfo),setTimeout((function(){t.processReZoom()}),500),r.finish(14);case 19:case"end":return r.stop()}}),r,null,[[2,11,14,19]])})))()},setProcessStatus:function(e){if(this.processNodeInfo=e,!this.isLoading&&null!=this.processNodeInfo&&null!=this.bpmnViewer){var t=this.processNodeInfo,r=t.finishedTaskSet,s=t.rejectedTaskSet,o=t.unfinishedTaskSet,i=t.finishedSequenceFlowSet,n=this.bpmnViewer.get("canvas"),a=this.bpmnViewer.get("elementRegistry");Array.isArray(i)&&i.forEach((function(e){if(null!=e){n.addMarker(e,"success");var t=a.get(e),r=t.businessObject.conditionExpression;r&&n.addMarker(e,"condition-expression")}})),Array.isArray(r)&&r.forEach((function(e){return n.addMarker(e,"success")})),Array.isArray(o)&&o.forEach((function(e){return n.addMarker(e,"primary")})),Array.isArray(s)&&s.forEach((function(e){if(null!=e){var t=a.get(e);t.type.includes("Task")?n.addMarker(e,"danger"):n.addMarker(e,"warning")}}))}}},destroyed:function(){this.clearViewer()}},d=l,u=r("2877"),f=Object(u["a"])(d,s,o,!1,null,"5f3d2f03",null);t["a"]=f.exports}}]);